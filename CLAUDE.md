# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

WV Data Displays is a WebSocket-based multi-display installation system for controlling multiple laptop screens from a single pilot control panel. Designed for LAN-based operation without internet dependency.

## Commands

```bash
# Install dependencies (includes pilot Vue app)
npm install

# Build pilot Vue app
npm run build

# Start server (port 3000)
npm start
```

**Access URLs:**
- Client displays: `http://<IP>:3000/`
- Pilot control: `http://<IP>:3000/pilot`

## Architecture

```
Pilot Control Panel (Vue.js app)
         ↓ WebSocket
   Node.js HTTP Server (port 3000)
         ↓ WebSocket
   Client Displays (browsers)
```

**Files:**
- `server.js` - HTTP + WebSocket server, handles client registration, message routing, content history, and static file serving
- `client.html` - Display interface with animations, effects, auto-reconnect, and idle breathing animation
- `pilot/` - Vue.js + shadcn-vue control panel application
  - `src/components/` - UI components (ClientList, panels)
  - `src/composables/` - WebSocket connection management
  - `src/components/ui/` - shadcn-vue base components
- `dist/pilot/` - Built pilot app (generated by `npm run build`)
- `scripts/copy-fonts.js` - Postinstall script that copies fonts from node_modules to `/fonts`

## Communication Protocol

JSON messages over WebSocket with structure:
```javascript
{
  type: 'send-text' | 'send-image' | 'send-tiled-image' | 'send-color' | 'cascade-text' | 'cascade-words' | 'clear' | 'effect',
  target: 'all' | <client-id>,
  // ... type-specific payload fields
}
```

**Key server functions:**
- `handlePilotMessage()` - Routes pilot commands to clients
- Client state tracked with auto-incrementing IDs ("Laptop N" naming)
- Content history replicated to newly connected clients

## Pilot App (Vue.js)

The pilot control panel is built with:
- Vue 3 + TypeScript
- Vite for building
- Tailwind CSS v3 for styling
- shadcn-vue components

**Development:**
```bash
cd pilot
npm run dev   # Dev server with hot reload (proxies to main server)
npm run build # Build for production
```

## Notes

- UI text is in German
- No authentication (LAN-only design)
- Client auto-reconnects on disconnect (2s interval)
- Fonts are local (no internet required) - installed via fontsource packages and copied to `/fonts` during `npm install`
- Images uploaded via pilot are stored in `/uploads` and served via HTTP
